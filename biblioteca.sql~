-- MySQL Script generated by MySQL Workbench
-- Sex 06 Mai 2016 16:36:25 BRT
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema biblioteca
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `biblioteca` ;

-- -----------------------------------------------------
-- Schema biblioteca
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `biblioteca` DEFAULT CHARACTER SET utf8 ;
USE `biblioteca` ;

-- -----------------------------------------------------
-- Table `biblioteca`.`usuario`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`usuario` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`usuario` (
  `idusuario` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(100) NOT NULL,
  `telefone` VARCHAR(15) NOT NULL,
  PRIMARY KEY (`idusuario`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'usuarios do sistema de bibliateca: \nauthor: deyvison Rodrigo';


-- -----------------------------------------------------
-- Table `biblioteca`.`autor`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`autor` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`autor` (
  `idautor` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`idautor`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'autores dos livros';


-- -----------------------------------------------------
-- Table `biblioteca`.`editora`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`editora` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`editora` (
  `ideditora` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(45) NULL,
  `cidade` VARCHAR(45) NULL,
  PRIMARY KEY (`ideditora`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `biblioteca`.`obra`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`obra` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`obra` (
  `idobra` INT NOT NULL AUTO_INCREMENT,
  `titulo` VARCHAR(60) NOT NULL,
  `ano_publicacao` VARCHAR(7) NOT NULL DEFAULT '00/0000',
  `ideditora` INT NOT NULL,
  PRIMARY KEY (`idobra`, `ideditora`),
  INDEX `fk_obra_editora1_idx` (`ideditora` ASC),
  CONSTRAINT `fk_obra_editora1`
    FOREIGN KEY (`ideditora`)
    REFERENCES `biblioteca`.`editora` (`ideditora`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `biblioteca`.`obra_autor`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`obra_autor` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`obra_autor` (
  `idobra_autor` INT NOT NULL AUTO_INCREMENT,
  `idautor` INT NOT NULL,
  `idobra` INT NOT NULL,
  PRIMARY KEY (`idobra_autor`, `idautor`, `idobra`),
  INDEX `fk_obra_autor_autor_idx` (`idautor` ASC),
  INDEX `fk_obra_autor_obra1_idx` (`idobra` ASC),
  CONSTRAINT `fk_obra_autor_autor`
    FOREIGN KEY (`idautor`)
    REFERENCES `biblioteca`.`autor` (`idautor`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_obra_autor_obra1`
    FOREIGN KEY (`idobra`)
    REFERENCES `biblioteca`.`obra` (`idobra`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `biblioteca`.`assunto`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`assunto` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`assunto` (
  `idassunto` INT NOT NULL AUTO_INCREMENT,
  `descricao` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`idassunto`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `biblioteca`.`obra_assunto`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`obra_assunto` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`obra_assunto` (
  `idobra` INT NOT NULL,
  `idassunto` INT NOT NULL,
  PRIMARY KEY (`idobra`, `idassunto`),
  INDEX `fk_obra_assunto_assunto1_idx` (`idassunto` ASC),
  CONSTRAINT `fk_obra_assunto_obra1`
    FOREIGN KEY (`idobra`)
    REFERENCES `biblioteca`.`obra` (`idobra`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_obra_assunto_assunto1`
    FOREIGN KEY (`idassunto`)
    REFERENCES `biblioteca`.`assunto` (`idassunto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `biblioteca`.`situacao`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`situacao` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`situacao` (
  `idsituacao` INT NOT NULL AUTO_INCREMENT,
  `descricao` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idsituacao`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'Situação:\n1 -> Disponivel\n2 -> Emprestado\n3 -> Em Manutencao';


-- -----------------------------------------------------
-- Table `biblioteca`.`exemplar`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`exemplar` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`exemplar` (
  `idexemplar` INT NOT NULL AUTO_INCREMENT,
  `data_aquisicao` DATE NOT NULL,
  `idobra` INT NOT NULL,
  `idsituacao` INT NOT NULL,
  PRIMARY KEY (`idexemplar`, `idobra`, `idsituacao`),
  INDEX `fk_exemplar_obra1_idx` (`idobra` ASC),
  INDEX `fk_exemplar_situacao1_idx` (`idsituacao` ASC),
  CONSTRAINT `fk_exemplar_obra1`
    FOREIGN KEY (`idobra`)
    REFERENCES `biblioteca`.`obra` (`idobra`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_exemplar_situacao1`
    FOREIGN KEY (`idsituacao`)
    REFERENCES `biblioteca`.`situacao` (`idsituacao`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `biblioteca`.`chefes`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`chefes` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`chefes` (
  `idchefes` INT NOT NULL,
  `nome` VARCHAR(60) NOT NULL,
  PRIMARY KEY (`idchefes`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'Chefes dos departamentos';


-- -----------------------------------------------------
-- Table `biblioteca`.`departamento`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`departamento` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`departamento` (
  `idDepartamento` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(45) NOT NULL,
  `idchefes` INT NOT NULL,
  PRIMARY KEY (`idDepartamento`, `idchefes`),
  INDEX `fk_departamento_chefes1_idx` (`idchefes` ASC),
  CONSTRAINT `fk_departamento_chefes1`
    FOREIGN KEY (`idchefes`)
    REFERENCES `biblioteca`.`chefes` (`idchefes`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'Departamento do funcionário que concedeu o empréstimo.\nDeyvison Rodrigo';


-- -----------------------------------------------------
-- Table `biblioteca`.`funcionario`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`funcionario` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`funcionario` (
  `idfuncionario` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(60) NOT NULL,
  `salario` DOUBLE NULL,
  `idDepartamento` INT NOT NULL,
  PRIMARY KEY (`idfuncionario`, `idDepartamento`),
  INDEX `fk_funcionario_departamento1_idx` (`idDepartamento` ASC),
  CONSTRAINT `fk_funcionario_departamento1`
    FOREIGN KEY (`idDepartamento`)
    REFERENCES `biblioteca`.`departamento` (`idDepartamento`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'Funcionário ligado a Devolução..\nDeyvison Rodrigo';


-- -----------------------------------------------------
-- Table `biblioteca`.`emprestimo`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`emprestimo` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`emprestimo` (
  `idemprestimo` INT NOT NULL AUTO_INCREMENT,
  `idusuario` INT NOT NULL,
  `idexemplar` INT NOT NULL,
  `data_emprestimo` DATE NOT NULL,
  `previsao_devolucao` DATE NOT NULL,
  `idfuncionario` INT NOT NULL,
  PRIMARY KEY (`idemprestimo`, `idusuario`, `idexemplar`, `idfuncionario`),
  INDEX `fk_emprestimo_usuario1_idx` (`idusuario` ASC),
  INDEX `fk_emprestimo_exemplar1_idx` (`idexemplar` ASC),
  INDEX `fk_emprestimo_funcionario1_idx` (`idfuncionario` ASC),
  CONSTRAINT `fk_emprestimo_usuario1`
    FOREIGN KEY (`idusuario`)
    REFERENCES `biblioteca`.`usuario` (`idusuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_emprestimo_exemplar1`
    FOREIGN KEY (`idexemplar`)
    REFERENCES `biblioteca`.`exemplar` (`idexemplar`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_emprestimo_funcionario1`
    FOREIGN KEY (`idfuncionario`)
    REFERENCES `biblioteca`.`funcionario` (`idfuncionario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1
COMMENT = 'Tabela de empréstimos\nDeyvison Rodrigo';


-- -----------------------------------------------------
-- Table `biblioteca`.`devolucao`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `biblioteca`.`devolucao` ;

CREATE TABLE IF NOT EXISTS `biblioteca`.`devolucao` (
  `iddevolucao` INT NOT NULL AUTO_INCREMENT,
  `idfuncionario` INT NOT NULL,
  `idemprestimo` INT NOT NULL,
  PRIMARY KEY (`iddevolucao`, `idfuncionario`, `idemprestimo`),
  INDEX `fk_devolucao_funcionario1_idx` (`idfuncionario` ASC),
  INDEX `fk_devolucao_emprestimo1_idx` (`idemprestimo` ASC),
  CONSTRAINT `fk_devolucao_funcionario1`
    FOREIGN KEY (`idfuncionario`)
    REFERENCES `biblioteca`.`funcionario` (`idfuncionario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_devolucao_emprestimo1`
    FOREIGN KEY (`idemprestimo`)
    REFERENCES `biblioteca`.`emprestimo` (`idemprestimo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `biblioteca`.`usuario`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (500, 'Deyvison Rodrigo', '(84) 98831-5655');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (501, 'Dervis Serafim', '(84) 98855-8756');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (502, 'Luan Anderson', '(84) 3212-2659');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (503, 'ALLAN DE MIRANDA SILVA', '(84) 3663-9647');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (504, 'ANDERSON CLAUDIO RODRIGUES DA SILVA', '(84) 8855-8875');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (505, 'ANDERSON PAULO DOS SANTOS CÂNDIDO', '(84) 98475-9685');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (506, 'BRUNO BAGYO DE MEDEIROS RAMOS', '(84) 99985-8547');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (507, 'DANILO RAFAEL DE SOUZA PEREIRA', '(84) 98831-5478');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (508, 'FRANCISCO OSNI SILVA DUARTE', '(84) 3256-9874');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (509, 'JÉSSICA CABRAL DE ARAÚJO', '(84) 8856-9874');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (510, 'JOSE HUMBERTO ALVES JUNIOR', '(84) 98845-7896');
INSERT INTO `biblioteca`.`usuario` (`idusuario`, `nome`, `telefone`) VALUES (511, 'OTTONY CHAMBERLAINE TAVARES DA COSTA', '(84) 97845-5698');

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`autor`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`autor` (`idautor`, `nome`) VALUES (58, 'Symon Haykin');
INSERT INTO `biblioteca`.`autor` (`idautor`, `nome`) VALUES (59, 'B. P. Lathi');

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`editora`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`editora` (`ideditora`, `nome`, `cidade`) VALUES (1, 'NOVATEC', 'RIO DE JANEIRO');
INSERT INTO `biblioteca`.`editora` (`ideditora`, `nome`, `cidade`) VALUES (2, 'BRASIL TI', 'RECIFE');

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`obra`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`obra` (`idobra`, `titulo`, `ano_publicacao`, `ideditora`) VALUES (1, 'Sistemas de Comunicação Edição 5', '2014', 1);
INSERT INTO `biblioteca`.`obra` (`idobra`, `titulo`, `ano_publicacao`, `ideditora`) VALUES (2, 'Sistemas de Comunicações Modernos', '2015', 2);

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`obra_autor`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`obra_autor` (`idobra_autor`, `idautor`, `idobra`) VALUES (1, 58, 1);
INSERT INTO `biblioteca`.`obra_autor` (`idobra_autor`, `idautor`, `idobra`) VALUES (2, 59, 2);

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`assunto`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`assunto` (`idassunto`, `descricao`) VALUES (1, 'Sistemas de telecomunicações e paracomunicações. Tecnologia da Informação.');

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`obra_assunto`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`obra_assunto` (`idobra`, `idassunto`) VALUES (1, 1);
INSERT INTO `biblioteca`.`obra_assunto` (`idobra`, `idassunto`) VALUES (2, 1);

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`situacao`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`situacao` (`idsituacao`, `descricao`) VALUES (1, 'disponível');
INSERT INTO `biblioteca`.`situacao` (`idsituacao`, `descricao`) VALUES (2, 'emprestado');
INSERT INTO `biblioteca`.`situacao` (`idsituacao`, `descricao`) VALUES (3, 'em manutenção');

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`exemplar`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`exemplar` (`idexemplar`, `data_aquisicao`, `idobra`, `idsituacao`) VALUES (1, '2015-03-04', 1, 1);
INSERT INTO `biblioteca`.`exemplar` (`idexemplar`, `data_aquisicao`, `idobra`, `idsituacao`) VALUES (2, '2015-03-04', 1, 1);
INSERT INTO `biblioteca`.`exemplar` (`idexemplar`, `data_aquisicao`, `idobra`, `idsituacao`) VALUES (3, '2015-03-04', 1, 1);
INSERT INTO `biblioteca`.`exemplar` (`idexemplar`, `data_aquisicao`, `idobra`, `idsituacao`) VALUES (4, '2016-01-20', 2, 1);
INSERT INTO `biblioteca`.`exemplar` (`idexemplar`, `data_aquisicao`, `idobra`, `idsituacao`) VALUES (5, '2016-01-20', 2, 1);

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`chefes`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`chefes` (`idchefes`, `nome`) VALUES (609, 'Marcio Eduardo');
INSERT INTO `biblioteca`.`chefes` (`idchefes`, `nome`) VALUES (603, 'Vicente Angelo');
INSERT INTO `biblioteca`.`chefes` (`idchefes`, `nome`) VALUES (600, 'Hertz Wilton');

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`departamento`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`departamento` (`idDepartamento`, `nome`, `idchefes`) VALUES (4, 'Engenharias', 609);

COMMIT;


-- -----------------------------------------------------
-- Data for table `biblioteca`.`funcionario`
-- -----------------------------------------------------
START TRANSACTION;
USE `biblioteca`;
INSERT INTO `biblioteca`.`funcionario` (`idfuncionario`, `nome`, `salario`, `idDepartamento`) VALUES (45, 'Monica Ferreira', 2500, 4);
INSERT INTO `biblioteca`.`funcionario` (`idfuncionario`, `nome`, `salario`, `idDepartamento`) VALUES (46, 'Gutemberg Cunha', 2000, 4);
INSERT INTO `biblioteca`.`funcionario` (`idfuncionario`, `nome`, `salario`, `idDepartamento`) VALUES (47, 'Amanda Suely', 2300, 4);

COMMIT;


